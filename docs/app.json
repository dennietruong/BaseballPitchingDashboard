[{"name":"app.R","content":"library(shiny)\r\nlibrary(shinythemes)\r\nlibrary(dplyr)\r\nlibrary(lubridate)\r\nlibrary(DT)\r\n\r\n# --- Load Data ---\r\nPitchData <- read.csv(\"PitchingData2025.csv\", stringsAsFactors = FALSE)\r\nPitchData$Date <- as.Date(PitchData$Date, format=\"%m/%d/%y\")\r\n\r\n# --- Convert innings ---\r\nconvert_inning <- function(inn_str) {\r\n  parts <- strsplit(as.character(inn_str), \"\\\\.\")[[1]]\r\n  whole <- as.numeric(parts[1])\r\n  outs <- ifelse(length(parts)>1, as.numeric(parts[2]), 0)\r\n  if (outs %in% 0:2) {\r\n    return(whole + outs/3)\r\n  } else stop(paste(\"Invalid outs value in:\", inn_str))\r\n}\r\n\r\nPitchData$ConvertedInnings <- sapply(PitchData$InningPitched, convert_inning)\r\n\r\n# --- ERA & WHIP ---\r\nCalcERA <- function(data, player) {\r\n  pdata <- subset(data, Name==player)\r\n  TotalIP <- sum(pdata$ConvertedInnings, na.rm=TRUE)\r\n  TotalER <- sum(pdata$RunScored, na.rm=TRUE)\r\n  if(TotalIP==0) return(NA)\r\n  (TotalER/TotalIP)*3\r\n}\r\n\r\nCalcWHIP <- function(data, player) {\r\n  pdata <- subset(data, Name==player)\r\n  TotalIP <- sum(pdata$ConvertedInnings, na.rm=TRUE)\r\n  if(TotalIP==0) return(NA)\r\n  (sum(pdata$BB,na.rm=TRUE)+sum(pdata$Hit,na.rm=TRUE))/TotalIP\r\n}\r\n\r\n# --- Base R Pie Charts ---\r\nBasePieCharts <- function(player_data){\r\n  par(mfrow=c(1,3), mar=c(5,4,5,2))  # margins with extra space for bigger titles\r\n  \r\n  # --- Pitch Profile ---\r\n  pitch_counts <- c(sum(player_data$Ball, na.rm=TRUE), sum(player_data$Strike, na.rm=TRUE))\r\n  if(sum(pitch_counts) == 0) pitch_counts <- c(1,1)  # prevent divide by zero\r\n  pitch_pct <- round(pitch_counts / sum(pitch_counts) * 100)\r\n  pitch_labels <- ifelse(pitch_pct > 0, paste0(c(\"Ball\",\"Strike\"), \" \", pitch_pct, \"%\"), \"\")\r\n  pie(pitch_counts, labels=pitch_labels, col=c(\"skyblue\",\"tomato\"), main=\"Pitch Profile\", cex.main=2.5, cex=1.5)\r\n  \r\n  # --- Out Profile ---\r\n  out_counts <- c(sum(player_data$GO, na.rm=TRUE), sum(player_data$FO, na.rm=TRUE), sum(player_data$SO, na.rm=TRUE))\r\n  if(sum(out_counts) == 0) out_counts <- c(1,1,1)\r\n  out_pct <- round(out_counts / sum(out_counts) * 100)\r\n  out_labels <- ifelse(out_pct > 0, paste0(c(\"Groundout\",\"Flyout\",\"Strikeout\"), \" \", out_pct, \"%\"), \"\")\r\n  pie(out_counts, labels=out_labels, col=c(\"lightgreen\",\"green\",\"forestgreen\"), main=\"Out Profile\", cex.main=2.5, cex=1.5)\r\n  \r\n  # --- At-Bat Result Profile ---\r\n  result_counts <- c(sum(player_data$GO, na.rm=TRUE),\r\n                     sum(player_data$FO, na.rm=TRUE),\r\n                     sum(player_data$SO, na.rm=TRUE),\r\n                     sum(player_data$BB, na.rm=TRUE),\r\n                     sum(player_data$Hit, na.rm=TRUE))\r\n  if(sum(result_counts) == 0) result_counts <- rep(1,5)\r\n  result_pct <- round(result_counts / sum(result_counts) * 100)\r\n  result_labels <- ifelse(result_pct > 0, paste0(c(\"Groundout\",\"Flyout\",\"Strikeout\",\"Walk\",\"Hit\"), \" \", result_pct, \"%\"), \"\")\r\n  pie(result_counts, labels=result_labels, col=c(\"lightgreen\",\"green\",\"forestgreen\",\"firebrick\",\"tomato\"), main=\"At-Bat Results\", cex.main=2.5, cex=1.5)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n# --- Overall stats ---\r\nPlayerNames <- unique(PitchData$Name)\r\nresults_df <- do.call(rbind, lapply(PlayerNames,function(player){\r\n  pdata <- subset(PitchData, Name==player)\r\n  data.frame(\r\n    Name=player,\r\n    IP=sum(pdata$ConvertedInnings,na.rm=TRUE),\r\n    Hits=sum(pdata$Hit,na.rm=TRUE),\r\n    Runs=sum(pdata$RunScored,na.rm=TRUE),\r\n    BB=sum(pdata$BB,na.rm=TRUE),\r\n    SO=sum(pdata$SO,na.rm=TRUE),\r\n    HR=sum(pdata$HR,na.rm=TRUE),\r\n    ERA=round(CalcERA(PitchData,player),3),\r\n    WHIP=round(CalcWHIP(PitchData,player),3),\r\n    stringsAsFactors=FALSE\r\n  )\r\n}))\r\n\r\n# --- UI ---\r\nui <- fluidPage(\r\n  theme=shinytheme(\"spacelab\"),\r\n  titlePanel(\"Pitching Dashboard\"),\r\n  \r\n  tabsetPanel(\r\n    tabPanel(\"Pitching Stats\",\r\n             DTOutput(\"pitching_table\")\r\n    ),\r\n    \r\n    tabPanel(\"Player Analysis\",\r\n             sidebarLayout(\r\n               sidebarPanel(\r\n                 selectInput(\"selected_player\",\"Select Player:\", choices=PlayerNames, selected=PlayerNames[1]),\r\n                 width=2\r\n               ),\r\n               mainPanel(\r\n                 h3(textOutput(\"selected_player_title\")),\r\n                 tableOutput(\"player_stats_table\"),\r\n                 h4(\"Team Averages\"),\r\n                 tableOutput(\"team_avg_table\"),\r\n                 plotOutput(\"pie_charts\", height=\"350px\")\r\n               )\r\n             )\r\n    ),\r\n    \r\n    tabPanel(\"Glossary\",\r\n             tags$ul(\r\n               tags$li(tags$strong(\"IP:\"),\"Innings Pitched\"),\r\n               tags$li(tags$strong(\"ERA:\"),\"Earned Run Average per 3 innings\"),\r\n               tags$li(tags$strong(\"WHIP:\"),\"Walks + Hits per IP\"),\r\n               tags$li(tags$strong(\"BB:\"),\"Walks issued\"),\r\n               tags$li(tags$strong(\"SO:\"),\"Strikeouts\"),\r\n               tags$li(tags$strong(\"HR:\"),\"Home Runs allowed\")\r\n             )\r\n    )\r\n  )\r\n)\r\n\r\n# --- Server ---\r\nserver <- function(input, output, session){\r\n  \r\n  output$pitching_table <- renderDT({\r\n    datatable(results_df, selection=\"single\", options=list(pageLength=15, scrollX=TRUE))\r\n  })\r\n  \r\n  selected_player <- reactiveVal(PlayerNames[1])\r\n  \r\n  observeEvent(input$pitching_table_rows_selected, {\r\n    sel <- input$pitching_table_rows_selected\r\n    if(length(sel)) selected_player(results_df$Name[sel])\r\n  })\r\n  \r\n  observeEvent(input$selected_player, { selected_player(input$selected_player) })\r\n  \r\n  output$selected_player_title <- renderText({\r\n    req(selected_player())\r\n    paste(\"Pitching Stats & Profiles for\", selected_player())\r\n  })\r\n  \r\n  output$player_stats_table <- renderTable({\r\n    req(selected_player())\r\n    results_df[results_df$Name==selected_player(), ]\r\n  }, rownames=FALSE)\r\n  \r\n  output$team_avg_table <- renderTable({\r\n    numcols <- sapply(results_df,is.numeric)\r\n    avg <- round(colMeans(results_df[,numcols]),3)\r\n    data.frame(Name=\"Team Average\", t(avg), stringsAsFactors=FALSE)\r\n  }, rownames=FALSE)\r\n  \r\n  output$pie_charts <- renderPlot({\r\n    req(selected_player())\r\n    pdata <- subset(PitchData, Name==selected_player())\r\n    BasePieCharts(pdata)\r\n  })\r\n  \r\n}\r\n\r\nshinyApp(ui, server)\r\n","type":"text"},{"name":"PitchingDashboard.Rproj","content":"Version: 1.0\r\n\r\nRestoreWorkspace: Default\r\nSaveWorkspace: Default\r\nAlwaysSaveHistory: Default\r\n\r\nEnableCodeIndexing: Yes\r\nUseSpacesForTab: Yes\r\nNumSpacesForTab: 2\r\nEncoding: UTF-8\r\n\r\nRnwWeave: Sweave\r\nLaTeX: pdfLaTeX\r\n","type":"text"},{"name":"PitchingData2025.csv","content":"ï»¿Name,Date,Location,InningPitched,Ball,Strike,FoulBall,GO,FO,Hit,HR,RunScored,BB,SO\r\nJustin T.,5/1/2025,Home,2.2,15,18,1,0,0,0,0,0,2,5\r\nBarton Z.,5/1/2025,Home,0.1,3,1,0,1,0,0,0,0,1,0\r\nNoah H.,5/1/2025,Home,1,7,10,1,0,0,0,0,0,0,3\r\nBarton Z.,5/2/2025,Home,1,26,11,0,0,0,1,0,2,4,3\r\nJustin T.,5/2/2025,Home,0.2,11,8,0,0,0,2,1,1,1,2\r\nNoah H.,5/2/2025,Home,0.2,16,10,1,0,0,0,0,0,3,2\r\nJustin T.,5/8/2025,Home,1.1,26,20,5,2,0,5,1,6,4,2\r\nBarton Z.,5/8/2025,Home,0.2,1,4,1,1,0,1,0,0,0,1\r\nBarton Z.,5/15/2025,Home,2.1,27,31,7,0,0,6,1,4,3,6\r\nNoah H.,5/15/2025,Home,0.2,3,6,0,0,0,0,0,0,0,2\r\nNoah H.,5/16/2025,Home,1,14,9,0,0,0,1,0,2,3,2\r\nBarton Z.,5/16/2025,Home,2,12,15,4,2,1,3,2,3,1,3\r\nEdgar C.,5/22/2025,Home,2,19,11,2,4,0,1,1,1,2,2\r\nEdgar C.,5/29/2025,Home,3,15,26,9,4,1,4,1,3,1,4\r\n","type":"text"}]
